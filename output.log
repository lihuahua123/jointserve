/usr/local/lib/python3.11/dist-packages/paramiko/pkey.py:100: CryptographyDeprecationWarning: TripleDES has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.TripleDES and will be removed from this module in 48.0.0.
  "cipher": algorithms.TripleDES,
/usr/local/lib/python3.11/dist-packages/paramiko/transport.py:259: CryptographyDeprecationWarning: TripleDES has been moved to cryptography.hazmat.decrepit.ciphers.algorithms.TripleDES and will be removed from this module in 48.0.0.
  "class": algorithms.TripleDES,
You are using the default legacy behaviour of the <class 'transformers.models.llama.tokenization_llama_fast.LlamaTokenizerFast'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565 - if you loaded a llama tokenizer from a GGUF file you can ignore this message.
INFO:server:Set CUDA_VISIBLE_DEVICES to 0
INFO:server:http://0.0.0.0:30000, ports: PortArgs(tokenizer_port=10000, router_port=10001, detokenizer_port=10002, nccl_port=10003, migrate_port=10004, model_rpc_ports=[10005, 10006, 10007])
INFO:model_rpc:Use sleep forwarding: False
INFO:model_rpc:schedule_heuristic: fcfs-mpq
1 0
INFO:model_runner:Rank 0: load weight begin.
INFO:model_runner:Rank 0: load weight end.
INFO:model_runner:kv one token size: 32 * 128 * 32 * 2 * 2 = 524288 bytes
model /hy-tmp/ loaded.
Fetching 2 files:   0%|          | 0/2 [00:00<?, ?it/s]Fetching 2 files: 100%|██████████| 2/2 [00:00<00:00, 10866.07it/s]
INFO:sglang.srt.weight_utils:Using model weights format ['*.bin']
INFO:model_rpc:Rank 0: max_total_num_token=12606, max_prefill_num_token=32768, context_len=32768, 
INFO:model_rpc:server_args: enable_flashinfer=True, attention_reduce_in_fp32=False, disable_radix_cache=False, disable_regex_jump_forward=False, disable_disk_cache=False, 
ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 664, in forward_step
    forward_times.append(self.forward_fill_batch(new_batch, forward_simulation))
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 1053, in forward_fill_batch
    ) = self.model_runner.forward(batch, ForwardMode.EXTEND)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_runner.py", line 546, in forward
    return self.forward_extend(batch,lora_uids)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_runner.py", line 488, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/models/llama2.py", line 268, in forward
    hidden_states = self.model(input_ids, positions, input_metadata, input_embeds)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/models/llama2.py", line 238, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/models/llama2.py", line 190, in forward
    hidden_states = self.self_attn(
                    ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/models/llama2.py", line 139, in forward
    attn_output = self.attn(q, k, v, input_metadata)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/layers/radix_attention.py", line 116, in forward
    return self.extend_forward(q, k, v, input_metadata)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/layers/radix_attention.py", line 90, in prefill_forward_flashinfer
    self.store_kv_cache(k, v, input_metadata)
  File "/root/preble/python/sglang/srt/layers/radix_attention.py", line 124, in store_kv_cache
    key_buffer[input_metadata.out_cache_loc] = cache_k
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


lora manager ready.
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[TokenizedGenerateReqInput(rid='c3cdecc87a6648f582a4013d6eb1a51b', input_text='Say this is a warmup request.', input_ids=[1, 14891, 445, 338, 263, 14294, 786, 2009, 29889], pixel_values=None, image_hash=None, image_size=None, sampling_params=<sglang.srt.sampling_params.SamplingParams object at 0x14b6531b9850>, return_logprob=False, logprob_start_len=0, top_logprobs_num=0, stream=False, arrival_time=1724501848.2051032, append_to_queue_time=1724501848.2086937)] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] <class 'list'>
[] ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


ERROR:model_rpc:Exception in ModelRpcClient:
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 314, in exposed_step
    self.forward_step()
  File "/usr/local/lib/python3.11/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/router/model_rpc.py", line 709, in forward_step
    self.token_to_kv_pool.available_size()
  File "/root/preble/python/sglang/srt/memory_pool.py", line 91, in available_size
    return torch.sum(self.mem_state == 0).item()
                     ^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


You pressed Ctrl+C! Shutting down all remote servers...
You pressed Ctrl+C! Shutting down all remote servers...
Exception ignored in: <function Runtime.__del__ at 0x14b500a668e0>
Traceback (most recent call last):
  File "/root/preble/python/sglang/srt/server.py", line 519, in __del__
    self.shutdown()
  File "/root/preble/python/sglang/srt/server.py", line 465, in shutdown
    psutil.wait_procs(children, timeout=5)
  File "/usr/local/lib/python3.11/dist-packages/psutil/__init__.py", line 1615, in wait_procs
    check_gone(proc, timeout)
  File "/usr/local/lib/python3.11/dist-packages/psutil/__init__.py", line 1576, in check_gone
    returncode = proc.wait(timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/psutil/__init__.py", line 1325, in wait
    self._exitcode = self._proc.wait(timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/psutil/_pslinux.py", line 1714, in wrapper
    return fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/psutil/_pslinux.py", line 1941, in wait
    return _psposix.wait_pid(self.pid, timeout, self._name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/psutil/_psposix.py", line 141, in wait_pid
    interval = sleep(interval)
               ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/psutil/_psposix.py", line 124, in sleep
    _sleep(interval)
  File "/root/preble/preble/multi_node_loader.py", line 36, in runtime_cleanup_handler
    sys.exit(0)
SystemExit: 0
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1511, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1504, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1377, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 555, in uvloop.loop.Loop._run
  File "uvloop/loop.pyx", line 474, in uvloop.loop.Loop._on_idle
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/server.py", line 68, in serve
    with self.capture_signals():
  File "/usr/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/server.py", line 328, in capture_signals
    signal.raise_signal(captured_signal)
  File "/root/preble/preble/multi_node_loader.py", line 36, in runtime_cleanup_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.11/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.11/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.11/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/server.py", line 102, in generate_request
    ret = await tokenizer_manager.generate_request(obj).__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/preble/python/sglang/srt/managers/tokenizer_manager.py", line 310, in generate_request
    await event.wait()
  File "/usr/lib/python3.11/asyncio/locks.py", line 213, in wait
    await fut
asyncio.exceptions.CancelledError
ERROR:    Traceback (most recent call last):
  File "/usr/lib/python3.11/asyncio/runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 1511, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1504, in uvloop.loop.Loop.run_until_complete
  File "uvloop/loop.pyx", line 1377, in uvloop.loop.Loop.run_forever
  File "uvloop/loop.pyx", line 555, in uvloop.loop.Loop._run
  File "uvloop/loop.pyx", line 474, in uvloop.loop.Loop._on_idle
  File "uvloop/cbhandles.pyx", line 83, in uvloop.loop.Handle._run
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/server.py", line 68, in serve
    with self.capture_signals():
  File "/usr/lib/python3.11/contextlib.py", line 144, in __exit__
    next(self.gen)
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/server.py", line 328, in capture_signals
    signal.raise_signal(captured_signal)
  File "/root/preble/preble/multi_node_loader.py", line 36, in runtime_cleanup_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/dist-packages/starlette/routing.py", line 741, in lifespan
    await receive()
  File "/usr/local/lib/python3.11/dist-packages/uvicorn/lifespan/on.py", line 137, in receive
    return await self.receive_queue.get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/asyncio/queues.py", line 158, in get
    await getter
asyncio.exceptions.CancelledError

Exception in thread Thread-1 (_wait_and_warmup):
Traceback (most recent call last):
  File "/usr/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "/usr/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/root/preble/python/sglang/srt/server.py", line 328, in _wait_and_warmup
    raise e
  File "/root/preble/python/sglang/srt/server.py", line 323, in _wait_and_warmup
    assert res.status_code == 200
           ^^^^^^^^^^^^^^^^^^^^^^
AssertionError
Server is on port 30000 on host 0.0.0.0 on pid 28853
You pressed Ctrl+C! Shutting down all remote servers...
Initialization failed. warmup error: 
You pressed Ctrl+C! Shutting down all remote servers...
